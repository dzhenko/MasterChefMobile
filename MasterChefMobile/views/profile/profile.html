<div data-role="view" data-title="Profile" data-layout="main-layout" data-model="app.profile.model">
    <div class="col-md-10 col-xs-10 col-lg-10 col-md-offset-1 col-xs-offset-1 col-lg-offset-1 container">
        <h3>
            Hello, <span id="profile-username" data-bind="source: username"></span>
        </h3>
        
         <div class="form-group">
           <div class="map-container">
                <span>The sandwiches waiting for you...</span>
                <img id="location-viz" width="300" height="300" src="#" alt="Google Static Map" />
           </div>
        </div>
        
        <div class="form-group">
            <label class="col-md-12 col-xs-12 col-lg-12"></label>
            <button data-bind="events: {click : logout}" class="btn btn-danger col-md-10 col-xs-10 col-lg-10 col-md-offset-1 col-xs-offset-1 col-lg-offset-1">Logout</button>
        </div>
    </div>
</div>

<script>
    startWatchingGeolocation();
    
    function startWatchingGeolocation() {
        navigator.geolocation.watchPosition(geoWatchSuccess, geoWatchError, {
                                                enableHighAccuracy: true,
                                                maximumAge: 1000
                                            });
        
       navigator.geolocation.getCurrentPosition(function(data) {
           console.log(data)
       });
    }

    function geoWatchSuccess(position) {
        var lat = position.coords.latitude;
        var long = position.coords.longitude;
        var heading = position.coords.heading;

        var mapsBaseUrl = "http://maps.googleapis.com/maps/api/staticmap";
        var centerPar = "center=" + lat + "," + long;
        var sizePar = "size=300x300";

        var locationViz = document.getElementById("location-viz");
        locationViz.src = mapsBaseUrl + "?" + centerPar + "&" + sizePar + "&" + "&sensor=true&zoom=12";
        locationViz.style.webkitTransform = "rotate(" + (-heading | 0) + "deg)";
    }

    function geoWatchError(error) {
        navigator.notification.alert("Cannot get your location!")
    }
</script>